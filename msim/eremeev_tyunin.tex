%%%%%%%%%%%%%%%%%%%%%%% ШАПКА %%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[twoside,a4paper]{msmb} % Класс документа [twoside,a4paper]
%%%%%%%%%%%%%%%%%%%% Параметры страницы %%%%%%%%%%%%%%%%%%%
\evensidemargin 5mm \oddsidemargin 5mm \voffset -10mm \textheight 230mm \textwidth 150mm
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{pscyr}  % Если установлен. Устанавливается вручную, используется при подготовке макета
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%  Удаляемый в сборке блок %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\yearpub{???}                                      % Год издания. Заполняет редакция.
\num{???}                                             % Номер журнала. Заполняет редакция.
\volume{???}                                         % Сквозная нумерация, том, выпуск
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%  Общие праметры для вёрстки и оформления  %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\filename}{eremeev}      % Вставьте имя вашего файла. Это необходимо для отслеживания конечной страницы статьи.

\newtheorem{theorem}{Теорема}
\newtheorem{lemma}{Лемма}
\newtheorem{corollary}{Следствие}
\newtheorem{proposition}{Утверждение}
\newtheorem{myalgorithm}{Алгоритм}
\newcommand {\MyBox}{\sqcup \hspace{-0.7em} \sqcap}
\newcommand {\y}{\mbox{\bf y}}
\newcommand {\x}{\mbox{\bf x}}
\def\R{\mathbb R}
\newcommand{\rr}{\text{\sc RoyalRoad}\hspace{0.1em}} % royal road
\newcommand {\A}{\mbox{\bf A}}
\newcommand {\B}{\mbox{\bf B}}
\newcommand {\E}{\mbox{\bf E}}
\newcommand {\W}{\mbox{\bf W}}
\newcommand {\z}{\mbox{\bf z}}


\shrtitle{Оптимизация фазированных антенных решеток}         % Часть названия статьи для колонтитулов.
\shrauthor{А.~Еремеев, Н.~Тюнин}{А.~Еремеев, Н.~Тюнин}  % Автор или группа авторов для оглавления и колонтитулов.
\udc{51.73}                               % Вставьте УДК.
\selectlanguage{russian}                    % Основной язык статьи
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%% для русскоязычной статьи и реферирования в РИНЦ  %%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{Алгоритм дифференциальной эволюции для оптимизации направленности фазированных антенных решеток} % Название статьи.
\author[1]{А.В.~Еремеев}{д.ф.-м.н., доцент}{eremeev@ofim.oscsbras.ru} % Автор на русском.
\author[1]{Н.Н.~Тюнин}{аспирант}{n.n.tyunin@gmail.com}
\affil[1]{Институт математики им. С.Л. Соболева СО РАН, Омский филиал, Омск}
\abstract{Задача оптимизации направленности фазированных антенных решеток для радиосвязи коротковолнового
диапазона сформулирована как невыпуклая задача квадратичного программирования. С учетом специфики рассматриваемой
задачи предложен гибридный алгоритм, основанный на методе дифференциальной эволюции, методе штрафных функций и
градиентной оптимизации. Корректировка недопустимых решений осуществляется посредством их масштабирования.
Штрафной коэффициент выбирается адаптивно в процессе работы алгоритма. Проведен вычислительный эксперимент,
в котором предложенный алгоритм сравнивается с коммерческим решателем BARON,
основанном на многократном применении алгоритма локального поиска и
методе ветвей и границ, а также с решателем ANTIGONE и градиентным алгоритмом.
Кроме того, исследован эффект от учета симметрий рассматриваемой задачи. По результатам
эксперимента можно сделать вывод о конкурентоспособности предложенного гибридного алгоритма, в
особенности на задачах большой размерности.
}

 \keywords{Задача оптимизации, фазированная антенная решетка, квадратичное программирование, коротковолновый диапазон,
дифференциальная эволюция}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%% для статьи на английском и рефрерирования %%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\titleEng{Differential evolution for directivity optimization of short-wave phased antenna arrays}     % Название статьи.
\authorEng[1]{A.V.~Eremeev}{Dr. Sci. (Phys.-Math.)}{eremeev@ofim.oscsbras.ru} % Автор на английском.
\authorEng[2]{N.N.~Tyunin}{p.g.}{n.n.tyunin@gmail.com}
\affilEng[1]{Dostoevsky Omsk State University, Omsk}  % Организация
\affilEng[2]{Sobolev Institute of Mathematics\\
SB RAS, Omsk department, Omsk}
\abstractEng{The problem of optimization of the directivity of phased antenna arrays for shortwave radio communication
is formulated as a nonconvex quadratic programming problem. Taking into account the specifics of the problem under
consideration, a hybrid algorithm based on the method of differential evolution, the method of penalty functions and
gradient optimization is proposed. Correction of invalid
solutions is carried out by means of their scaling. The penalty coefficient is chosen adaptively during the algorithm execution.
A computational experiment was carried out,
where the proposed algorithm is compared with the commercial solver BARON,
based on repeated application of the local search algorithm and
branch and bound method, as well as with the ANTIGONE solver and the gradient algorithm.
In addition, the effect of accounting for symmetries of the considered problem is studied. According to the results
experiment, we can conclude that the proposed hybrid algorithm is competitive,
especially on problems of higher dimension.
} % это аннотация статьи на ангнлийском языке
\keywordsEng{Optimization problem, phased antenna array, quadratic programming, shortwave, differential evolution}

\maketitle % Формирование оглавления.

%%%%%%%%%%%%%%%%%%%%%% Т Е К С Т %%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Введение}
В настоящее время одной из актуальных задач в области разработки и анализа эффективных систем радиосвязи
является задача оптимизации направленности фазированных антенных решеток (ФАР), представляющих собой антенные системы,
распределение фаз и амплитуд на элементах которых позволяет получать направленное излучение.
Будучи собранными в антенную систему и разведенными в пространстве, излучатели формируют диаграмму направленности,
которая зависит от расположения и конструкции излучателей, а также выбора фаз и амплитуд сигналов, подаваемых на вход излучателей.

В диапазоне сверхвысоких частот (СВЧ) задачи оптимизации фаз и амплитуд излучателелей, как правило, решаются с использованием
некоторых упрощающих предположений~\cite{indenbometal:synthesis,schelkunov:antenny,fanyaev2017}. Однако, в диапазоне высоких частот (ВЧ)
задача оптимизации направленности ФАР оказывается более сложной, и потому менее изучена~\cite{kudin2014,yurkov:knd}.
При ограничении суммарной мощности, подаваемой на антенную систему, задача выбора фаз и амплитуд на излучателях
может быть решена аналитически~\cite{yurkov:farkv}.
Однако, при ограничении на мощность по каждому входу антенной системы требуется решение невыпуклых задач квадратичного
программирования~\cite{fuchs:application}. Вообще говоря, задачи квадратичного программирования являются
NP-трудными~\cite{murty:np}. Для решения таких задач могут применяться методы ветвей и границ~\cite{nechaeva:bandb},
отсечений~\cite{horst:handbook}, DC-программирования~\cite{strekalovsky:mindc}, полуопределенной
релаксации~\cite{fuchs:application}, эволюционных вычислений~\cite{boriskinetal:efficient,rao:synthesis},
локального поиска~\cite{kochetov:local} и др.

Настоящая работа посвящена
разработке алгоритмов решения задачи оптимизации направленного излучения ФАР ВЧ диапазона с
использованием градиентного подъема и эволюционных вычислений. В разделе~\ref{sec:basic} вводятся основные обозначения,
дается математическая формулировка задачи и описывается ее сведение к задаче безусловной оптимизации методом штрафных функций.
С учетом специфики рассматриваемой
задачи в разделе~\ref{sec:sym:de} предложен гибридный алгоритм, основанный на методе дифференциальной эволюции и
градиентной оптимизации. Корректировка недопустимых решений осуществляется посредством их масштабирования.
Штрафной коэффициент выбирается адаптивно в процессе работы алгоритма. В разделе~\ref{sec:exp:de} приводятся
результаты вычислительного эксперимента,
в котором предложенный алгоритм сравнивается с коммерческим решателем BARON,
основанном на многократном применении алгоритма локального поиска и
методе ветвей и границ, а также с решателем ANTIGONE и градиентным алгоритмом.
Кроме того, исследован эффект от учета симметрий рассматриваемой задачи.
В разделе~\ref{sec:conclusion} содержатся заключения.
% Результаты данной работы были кратко представлены в тезисах конференции~\cite{tyu:motor22}.

\section{Основные обозначения} \label{sec:basic}

Математическая постановка задачи оптимизации направленности ФАР формулируется из физических соображений в виде выпуклого
квадратичного функционала при невыпуклых квадратичных ограничениях~\cite{yurkov:farkv}:
\begin{equation}
    \begin{cases}
       \textbf{u}^{+}\textbf{Au} \rightarrow \max,\\
       0 \leq \textbf{u}^{+}\textbf{B}^{(1)}\textbf{u} \leq, \\
       ...\\
       0 \leq \textbf{u}^{+}\textbf{B}^{(N)}\textbf{u} \leq 1.\\
       \textbf{u} \in \mathbb{C}^N\\
     \end{cases}
     \label{eq:task1}
\end{equation}


Здесь $n$ -- количество излучателей в системе. Матрица $\textbf{A}$ описывает влияние каждого элемента системы на ее
излучение вдоль заданного направления. Ограничения, описываемые матрицами $\textbf{B}_k, k = \overline{1,N},$
накладываются на мощность, которую генератор сигнала способен подать на каждый излучатель. Вектор \textbf{u}
представляет собой вектор-столбец комплексных напряжений.
%Исследование возможности оптимизация фаз и амплитуд  этих величин и является целью данной работы.

Для построения алгоритмов анализа и решения данной задачи был предложен переход от постановки в комплексных
числах к постановке в вещественных~\cite{tyunin:daor}:

\begin{equation}
    \begin{cases}
       \textbf{x}^{T}\textbf{Gx} \rightarrow \max,\\
       0 \leq \textbf{x}^{T}\textbf{H}^{(1)}\textbf{x} \leq 1,\\
       ...\\
       0 \leq \textbf{x}^{T}\textbf{H}^{(N)}\textbf{x} \leq 1,\\
      \textbf{x} \in \mathbb{R}^{2n}.\\
     \end{cases}
     \label{eq:task2}
\end{equation}

Здесь матрица $\textbf{G}$ вычисляется по матрице $\textbf{A}$, а матрицы
$\textbf{H}_k, k = \overline{1,N}$ -- по матрицам $\textbf{B}_k, k = \overline{1,N}$.

Ранее было показано~\cite{tyunin:daor}, что задача~(\ref{eq:task1}) имеет тривиальную
симметрию $\textbf{u} \to e^{\emph{\textbf{j}}\phi}\textbf{u}$, где $\textbf{j}$ -- мнимая единица,
$\phi$ -- фазовый сдвиг, одинаковый во всех компонентах вектора~$\textbf{u}$. При исследовании структуры
локальных оптимумов в указанной работе было отмечено, что, возможно, задача~(\ref{eq:task1}) имеет и другие симметрии.

Также, в работе~\cite{tyunin:daor} для отыскания локального оптимума использовался многократный запуск градиентного подъема.
Здесь для этих целей предлагается гибридный алгоритм, сочетающий элементы градиентного метода и дифференциальной эволюции.

При этом, задача~(\ref{eq:task2}) сводится к задаче безусловной оптимизации методом внешней точки в виде~(\ref{eq:task3})
\begin{equation}
       \textbf{x}^{T}\textbf{Gx} - r\cdot \sum_{k=1}^n
       \left( \min\left(0,\textbf{x}^{T}\textbf{H}^{(k)}\textbf{x}\right) +
       \min\left(0,1-\textbf{x}^{T}\textbf{H}^{(k)}\textbf{x}\right)\right)^{a} \rightarrow
       \max,
     \label{eq:task3}
\end{equation}

где $r$ и $a$ -- настраиваемые параметры. Далее в настоящей работе полагаем $a:=2.$

\section{Дифференциальная эволюция}\label{sec:sym:de}
\subsection{Базовый вариант алгоритма}\label{sec:sym:mod}

Эволюционные алгоритмы~(ЭА) — один из наиболее широко используемых методов решения многоэкстремальных задач оптимизации,
применяемый во многих областях информатики, экономики, инженерии и др.
Дифференциальная эволюция~(ДЭ)~\cite{storn:de} — один из наиболее эффективных ЭА непрерывной оптимизации.
В частности, ДЭ была признана стратегией-победителем нескольких конкурсов по оптимизации~\cite{das:de}.
Подобно другим эволюционным алгоритмам, ДЭ вдохновлен естественным процессом эволюции и включает в себя применение мутаций,
рекомбинации и селекции. Основная особенность ДЭ заключается в том, что в этом алгоритме при построении особей-потомков
учитываются разницы между векторами,
присутствующими в популяции. В этом смысле он похож на алгоритм Нелдера-Мида~\cite{nelder:simplex}.
% и метод CRS из~\cite{price:global}.

ДЭ -- рандомизированный алгоритм, основанный на популяционном поиске, в котором на каждой итерации вычисляется
новый набор пробных решений (векторов). В базовом варианте ДЭ для каждого члена
популяции~(их называют целевыми векторами) создается новый мутантный вектор.
Затем мутантный вектор комбинируют с целевым вектором для создания пробного вектора.
Наконец, применяется фаза селекции для выбора особей следующей популяции.
Таким образом, итерации ДЭ продолжаются, пока не будет достигнут критерий остановки.
В поколении $G$ $i$-й вектор популяции обозначается как $\textbf{X}_{i,G} = [x_{1,i,G}, x_{2,i,G}, ..., x_{D,i,G}]$.
Ниже приведены более подробные сведения о каждой фазе ДЭ.

Эксперименты показывают~\cite{storn:de_practical}, что в целом эволюция популяции такова, что
в случае попадания популяции в некоторый <<овраг>>, популяция ориентируется вдоль этого оврага и
математическое ожидание разности двух случайных векторов оказывается направленным вдоль оврага.
Это обеспечивает быстрое движение вдоль узких оврагов, тогда как для градиентных методов в
аналогичных условиях характерна колебательная динамика «от стенки к стенке». Приведенные эвристические
соображения иллюстрируют наиболее важную и привлекательную особенность алгоритма ДЭ -- способность динамически
адаптироваться к особенностям рельефа оптимизируемой функции. Именно этим объясняется способность алгоритма быстро проходить
сложные овраги, обеспечивающая его способность к поиску оптимальных или близких к оптиуму решений.

\paragraph*{Инициализация.}

ДЭ обычно начинает процесс оптимизации со случайно инициированной популяции, состоящей из $D$ векторов.
Поскольку информация о перспективности различных областей пространства решений, как правило, отсутствует,
для инициализации ДЭ применяются равномерные генераторы случайных векторов в параллелепипеде с некоторыми
границами $a_i$, $b_i$ по каждой координате
$j$, т.е. $j$-я компонента $i$-го вектора
инициализируется как $x_{j, i, 0} = a_{j} + rand_{i,j}(b_j - a_j )$,
где величина $rand_{i,j}$ выбрана с равномерным распределением между 0 и 1.

\paragraph*{Мутация.}

Для каждого целевого вектора создается мутантный вектор. В настоящее время известно несколько вариантов этого оператора.
В классическом варианте ДЭ применяется стратегия $rand/1$. В этом случае мутантный вектор $\textbf{V}_{i,G}$ создается следующим
образом:

\begin{equation}\label{eq:de_mut}
  \textbf{V}_{i,G} = \textbf{X}_{r_1,G} + F \cdot (\textbf{X}_{r_2,G} - \textbf{X}_{r_3,G}), \ r_1 \neq r_2 \neq r_3,
\end{equation}
где $r_1, r_2, r_3 $ -- попарно различные целые числа, случайно выбранные из множества $\{1,...,D\}\backslash i$.
Разница между векторами масштабируется множителем $F$, который
называется {\em силой мутации} и обычно определяется в интервале [0.4, 1].

\paragraph*{Рекомбинация.}

Для объединения информации о различных пробных решениях и с целью увеличения разнообразия в популяции применяется оператор
кроссинговера (рекомбинации). Каждый целевой вектор~$\textbf{X}_{i,G}$ рекомбинируется с соответствующим ему мутантным
вектором~$\textbf{V}_{i,G}$ для создания пробного решения $\textbf{U}_{i,G} = [u_{1,i,G}, u_{2,i,G}, ..., u_{D,i,G}]$.
Наиболее типичный вариант кроссинговера в ДЭ действует следующим образом:
\begin{equation}\label{eq:de_crossover}
  \textbf{u}_{j,i,G} =
    \begin{cases}
     v_{j,i,G}, & \mbox{если~} rand_{i,j} \leq CR \mbox{~или~} j = j_{rand} \\
     x_{j,i,G} & \mbox{иначе},
    \end{cases},
\end{equation}
где $rand_{i,j}$ -- равномерно на $[0, 1]$ распределенное случайное число, $j_{rand}$ -- случайно выбранный индекс. При этом
гарантируется, что $\textbf{U}_{i,G}$ наследует хотя бы одну компоненту от $\textbf{V}_{i,G}$. Параметр
$CR \in [0, 1]$ называется {\em интенсивностью кроссинговера}.

\paragraph*{Селекция.}

Наконец, выполняется отбор для определения следующего поколения. Каждый пробный вектор сравнивается с соответствующим
ему целевым вектором, и выживает лучший из них:

\begin{equation}\label{eq:de_sel}
  \textbf{X}_{i,G+1} =
  \begin{cases}
    \textbf{U}_{i,G}, & \mbox{если} \ \tilde{F}(\textbf{U}_{i,G}) \leq \tilde{F}(\textbf{X}_{i,G}) \\
    \textbf{X}_{i,G} & \mbox{иначе}.
  \end{cases}
\end{equation}

Таким образом, каждый член популяции либо становится лучше по целевой функции, либо остается с тем же значением
целевой функции в следующем поколении.

\subsection{Гибридный вариант алгоритма дифференциальной эволюции}
Будучи примененным к различным примерам из~\cite{tyunin:daor}, описанный выше базовый вариант алгоритма
дифференциальной эволюции зачастую не мог обнаружить даже допустимых решений за все отведенное ему время.
Чтобы избежать этой тенденции, в данной работе предложен гибридный вариант ДЭ с использованием градиентного метода,
масштабированием решений в допустимую область и адаптацией штрафа, учитывающий специфику решаемой задачи.

Комбинация ДЭ с градиентным подъемом реализуется следующей процедурой, выполняемой перед переходом к следующему поколению~$G+1$:

\begin{flushleft}
\small
Пусть
$G_0$ -- \verb"номер поколения, когда было последнее улучшение рекорда,"\\
%$D$ -- \verb"размер популяции,"\\
$Grad(X)$ -- \verb"результат применения градиентного подъема с начальным решением "$X,$\\
$X_G$ -- \verb"лучшая особь популяции на итерации "$G.$\\
$\mbox{ }$\\

\textit{Если} $G > D$ \textit{и} $G > 2 G_0,$ \textit{то положить} \\
\leftskip=12pt
    $X' := Grad(X_G).$\\
    \textit{Если} $X'$ = $X_G,$ \textit{то} \verb"завершить выполнение алгоритма, выдать решение" $X_G.$\\
    \textit{Иначе положить} \\
    \leftskip=24pt
        $X_G := X',$\\
        $G_0 := G.$\\
        \leftskip=12pt
\end{flushleft}
Условие $G > 2 G_0$ показывает отсутствие улучшения рекордного значения целевой функции за то же число итераций,
которое было затрачено на получение этого рекорда.
Условие $G > D$ гарантирует, что на начальных итерациях ДЭ не будет принято решение о запуске градиентного
алгоритма~\cite{BN98,HK93}. Здесь и далее под улучшением рекордного значения понимается увеличение лучшего
найденного значения целевой функции в очередном поколении~$G$ не менее, чем на~$\varepsilon$, где параметр $\varepsilon$
тот же, что и в критерии остановки градиентного алгоритма (по минимальному допустимому приращению целевой функции)~\cite{tyunin:daor}.

\paragraph*{Масштабирование решений.}
Для рассматриваемой задачи существует преобразование, позволяющее привести к
допустимой области любое решение $\textbf{x}$, которое нарушает только неравенства задачи~(\ref{eq:task3}) вида
$\textbf{x}^{T}\textbf{H}^{(k)}\textbf{x} \leq 1$:

\begin{equation}
    \textbf{x}': =\alpha(\textbf{x})^{-1/2} \textbf{x} ,
    \label{eq:scale}
\end{equation}
где $\alpha(\textbf{x}):=\max_{k=\overline{1,n}} \textbf{x}^T \textbf{H}^{(k)}\textbf{x}$. Поскольку как целевая функция, так и
ограничения представлены квадратичными формами, применение такой операции приведет к пропорциональному уменьшению
в~$\alpha(\textbf{x})$ раз значений каждой из квадратичных форм. Другими словами, если в некоторой точке $\textbf{x}$
значения каждой из квадратичных форм, задающих ограничения, больше 0, причем значения некоторых из них
больше 1, то по формуле (\ref{eq:scale}) можно определить множитель, умножение которого на вектор $\textbf{x}$ ведет к тому,
что наибольшее из значений квадратичных форм, задающих ограничения, будет равно 1. Данная процедура применяется для
выбора начального решения, а также для масштабирования каждого нового решения перед оценкой его качества в алгоритме ДЭ
и после завершения градиентного подъема.
При этом, если решение до масштабирования имело большие нарушения ограничений, то после масштабирования его целевая функция
существенно изменяется (как правило, в сторону снижения качества).
На этом принципе основано адаптивное правило подбора штрафного коэффициента~$r$, описываемое далее.

% Кроме того, для улучшения качества решений в гибридном варианте предлагается динамическое увеличение штрафного коэффициента:

\begin{flushleft}
\small
Пусть
$G$ -- \verb"номер текущей итерации," \\
$G_0$ -- \verb"номер итерации, на которой было получено улучшение рекорда,"\\
$G_1$ -- \verb"номер итерации, на которой произошло предыдущее увеличение штрафа,"\\
%$D$ -- \verb"размер популяции,"\\
$r$ -- \verb"текущее значение штрафного коэффициента."\\
$\mbox{ }$\\

\textit{Если} $G > D$ \textit{и} $G > 1.5 G_0$ \textit{и} $G > 2 G_1,$  \textit{то положить} \\
\leftskip=12pt
    $r := 2r$\\
    $G_1 := G.$\\
    \leftskip=0pt
\end{flushleft}

Таким образом, при отсутствии существенных улучшений качества решений на протяжении $G_0/2$ итераций, еще до
вызова градиентного алгоритма и до окончания работы ДЭ делается попытка улучшить найденный результат за счет увеличения штрафа.
Условие $G > D$ гарантирует, что на начальных итерациях не будет принято решение об увеличении штрафа.
%, а условие $G > 1.5 G_0$ означает что рекордное значение целевой функции не было улучшено за $G_0/2$ итераций.
Условие $G > 2 G_1$ вводится для того, чтобы штрафной коэффициент не увеличивался слишком часто.
%Таким образом, при отсутствии существенных улучшений качества решений происходит увеличение штрафного коэффициента.
С учетом масштабирования особей в допустимую область, описанный механизм увеличения штрафа, как правило,
приводит к выживанию особей с меньшим нарушением ограничений и позволяет улучшить качество получаемых решений.

\section{Вычислительный эксперимент}\label{sec:exp:de}

Вычислительный эксперимент был поставлен для задач, рассмотренных в~\cite{tyunin:daor,tyunin:oniip}. В данной
статье ШВИК, ШВДК, СВДК обозначают решетки кольцевой структуры. Далее следует указание количества элементов (8 или 16).
Через тире -- расстояние (метры) от центра излучателя до центра решетки (15, 20, 25, 30, 37). Для ШВД приводится плотность противовесов (например, 3:3). Поскольку современные ЭВМ на аппаратном уровне поддерживают вычисление в параллельном режиме, рассматриваемый здесь алгоритм ДЭ был адаптирован под эту особенность: за один запуск алгоритма производится 4 параллельных выполнения, а на выход подается лучшее решение. Это позволяет использовать возможности современных ЭВМ для получения более качественных решений.
В таблице~\ref{tab:results_de} результаты, полученные с помощью градиентного подъема из~\cite{tyunin:daor} и гибридного алгоритма дифференциальной эволюции~(ДЭ),
сравниваются с результатами коммерческого решателя BARON версии~18.11.12 из пакета GAMS.
%В колонке BARON* показаны результаты, полученные решателем BARON при учете фазовой симметрии. Для ДЭ также были произведены эксперименты при учете симметрии, однако, их результаты практически идентичны результатам ДЭ без учета симметрии, поэтому, в таблице~\ref{tab:results_de} они не приводятся. Поскольку решатель BARON в пакете GAMS в режиме по умолчанию имеет ограничение по времени 1000с., ДЭ также использует этот лимит.
Все сравниваемые алгоритмы имеют ограничение по времени счета 1000с (эта длительность выбрана из практических соображений, т.к. она сопоставима с временем построения исходных данных с использованием системы NEC, и совпадает с ограничением по времени, выбранным в~\cite{tyunin:daor}).
%В случае, если ДЭ получит решение раньше установленного временн\'{о}го ограничения, производится повторный запуск алгоритма до тех пор, пока это ограничение не будет исчерпано. За
В случае нескольких запусков ДЭ за отведенное время, за окончательное решение принимается лучшее из найденных за 1000с.
Для оценки среднего значения целевой функции на выходе ДЭ производилась серия из 10 независимых испытаний по
1000с в каждом. Эксперимент с гибридным алгоритмом ДЭ проводился при выборе типичных значений настраиваемых параметров
(популяция из 100 особей, $F=0.6$, $CR=0.6$). Значения целевой функции в таблице округлены до целых.
Полужирным шрифтом выделены случаи, когда указанное значение целевой функции не менее, чем на 1\% выше, чем у других алгоритмов.
Вычисления производились на ЭВМ с процессором Intel i7 (тактовая частота: 2.8ГГц), ОЗУ: 16Гб.

\begin{table}[!h]

\centering
\caption{ Результаты градиентного подъема, гибридного алгоритма ДЭ и BARON}
\begin{tabular}{|c|c|c|cc|c c|}
    \hline
    \multirow{2}{*}{\textbf{Тип}} & \textbf{град. подъем} & \textbf{ДЭ} & \multicolumn{2}{|c|}{\textbf{BARON}} \\
    & \textbf{$\tilde{F}$} & \textbf{$\tilde{F}$} & \textbf{$\tilde{F}$} & \textbf{t, c}  \\
    \hline
    ШВИ 2х2         & ${138}$  & ${139}$   & 139    & 0.12      \\
    ШВИ 3х3         & ${576}$ & ${580}$   & 580    & 0.34       \\
    ШВД 2х2         & ${460}$ & ${463}$   & 463    & 0.27     \\
    ШВД 3х3         & ${915}$ & ${924}$   & 925    & 0.34        \\
    СВД 2х2        & ${357}$  & ${361}$   & 361    & 0.16         \\
    СВД 3х3        & ${1138}$ & 1163  & $\mathbf{1261}$   & 0.38     \\
    СВД 5х5        & ${5318}$  & $\mathbf{7132}$  & 6716   & 1000   \\
    СВД' 2х2       & ${233}$ & 198   & $\mathbf{253}$    & 0.25         \\
    СВД' 3х3       & ${664}$ & 834   & $\mathbf{1153}$   & 1.4          \\
    СВД' 5х5       & ${1382}$  & $\mathbf{2755}$  & 33     & 217.94     \\
    ШВИК 8-15(3:3) & ${217}$  & ${218}$   & 218    & 0.23       \\
    ШВИК 16-15(3:7)& ${727}$  & ${732}$   & 734    & 1.37     \\
    ШВИК 8-15(2:3) & ${1536}$  & $\mathbf{1664}$     & -   & 14.62     \\
    ШВДК 8-20      & ${1454}$  & ${1454}$  & 1455   & 2.78       \\
    ШВДК 8-30      & ${2422}$  & ${2422}$  & 2422   & 1.47     \\
    СВДК 8-25      & ${740}$  & ${740}$   & 740    & 0.23        \\
    СВДК 8-37      & ${1487}$  & ${1487}$  & 1487   & 0.23      \\
    \hline
\end{tabular}
\label{tab:results_de}
\end{table}

%Также в результате проведенных экспериментов были получены другие результаты, не отраженные в таблице~\ref{tab:results_de} для краткости изложения.
Aналогичные испытания производились и с помощью решателя ANTIGONE версии~39.1.0 в пакете GAMS, однако, было выявлено, что в режиме по умолчанию данный решатель на всех задачах выдал нулевое решение, кроме СВД~2х2, где решение по целевой функции совпадало с результатом BARON.
Также, в результате проведенных экспериментов было обнаружено, что динамическая адаптация штрафного коэффициента позволяет ДЭ достичь более качественных решений, что особенно заметно в тех случаях, когда результаты ДЭ и BARON близки по качеству.

С целью изучения возможности ускорения работы решателей за счет учета специфики задачи были проведены дополнительные исследования
структуры рассматриваемых примеров с точки зрения линейных симметрий этих задач~\cite{yurkov:symmetry}.
Ранее было отмечено (см.~\cite{tyunin:daor}), что решения рассматриваемой задачи эквивалентны с точностью до сдвига
фаз во всех излучателях на равную величину.
Учет данной симметрии (для краткости называемой <<фазовой симметрией>>) может
быть реализован фиксацией в ноль одной из переменных задачи, например, $x_1=0$.
В результате добавления такого ограничения к условиям задачи число переменных сокращается
на единицу и можно предположить, что это сократит время вычислений для известных алгоритмов.
Нами поставлены вопросы о том, действительно ли происходит сокращение времени вычислений и о
существовании других семейств симметрий, которые могли бы еще более сократить пространство поиска решаемой задачи.

Для ответа на первый вопрос на всех тестовых примерах был найден коэффициент ускорения решателя BARON,
получаемый от фиксации $x_1=0$. Результаты представлены на рисунке~1 (здесь отсутствует задача СВД' 5х5, где
алгоритм с фиксацией затратил существенно большее время, но при этом нашел решение с большим на 10\% значением
целевой функции, а также задача ШВИК 8-15(2:3), в которой решения не были найдены в обоих случаях).
 большинстве примеров фиксация переменной привела к ускорению работы алгоритма, среднее ускорение по
представленным здесь задачам составило 0.95, что говорит о целесообразности фиксации в ноль одной из переменных
при использовании решателя. Аналогичный эксперимент с алгоритмом ДЭ и решателем ANTIGONE не показал существенного
улучшения качества решений или их ускорения в результате фиксации~$x_1$.

Для ответа на второй вопрос был проведен поиск непрерывой группы линейных симметрий в рассматриваемых примерах,
как описано в~\cite{yurkov:symmetry}. В результате было установлено, что других непрерывных семейств линейных
симметрий в рассматриваемых примерах не существует. Вопрос о поиске дискретных симметрий остается открытым.

\begin{figure}
\center{\includegraphics[width=0.6\linewidth]{ratio.eps}}
\caption{Отношение длительности вычислений с фиксацией первой координаты к исходной длительности вычислений}
\label{ris:ring}
\end{figure}

Из проведенных экспериментов можно сделать следующие выводы:\\
%\begin{itemize}
%  \item 
1) разработанный в рамках данной работы гибридный вариант ДЭ показывает конкурентоспособные результаты по сравнению с коммерческим решателем BARON в режиме его настроек по умолчанию, при этом преимущество ДЭ наблюдается на задачах с наибольшей размерностью (50 и 16 переменных);\\
2) решатель ANTIGONE в режиме его настроек по умолчанию в большинстве тестовых примеров давал нулевое решение;\\
3) учет фазовых симметрий задачи~(\ref{eq:task1}) в большинстве случаев позволяет ускорить работу решателя BARON.\\
%4) других непрерывных семейств линейных симметрий в рассматриваемых задачах не существует.
%\end{itemize}

\section{Заключение}\label{sec:conclusion}

В рамках данной работы был разработан гибридный вариант алгоритма дифференциальной эволюции с использованием
градиентного алгоритма и адаптацией штрафа. Показано, что разработанный вариант ДЭ демонстрирует конкурентоспособные результаты, в
особенности на задачах большой размерности. Произведено сравнение гибридного алгоритма и коммерческих решателей с
учетом фазовой симметрии, имеющейся в рассматриваемой задаче, и без нее. В ходе эксперимента, учет симметрии в большинстве 
случаев приводил к ускорению работы решателя BARON.

\section*{Благодарности} Авторы благодарны А.С. Юркову за постановку задачи и полезные замечания.
Работа выполнена в рамках государственного задания ИМ СО РАН (проект FWNF-2022-0020).

\begin{thebibliography}{35}

\bibitem{indenbometal:synthesis}
\textbf{Indenbom\;M., Izhutkin\;V., Sharapov\;A., Zonov\;A.} Synthesis of conical phased antenna arrays 
optimization of amplitude distribution parameters~// IX International Conference on Optimization and Applications 
(OPTIMA 2018). 2018. P.~273--285.

%rus
\bibitem{schelkunov:antenny}
\textbf{Щелкунов\;С.\;А., Фрис\;Г.} Антенны: Теория и практика. Советское радио, Москва, 1955.

%rus
\bibitem{fanyaev2017}
\textbf{Фаняев\;И.\;А, Кудин\;В.\;П.} Синтез амплитудного распределения на входах излучателей фазированной антенной 
решетки над цилиндрической поверхностью методом роя частиц~// Доклады БГУИР. 2017. С.~89--96.

%rus
\bibitem{kudin2014}
\textbf{Фаняев\;И.\;А., Кудин\;В.\;П.} Фазированная антенная решетка кругового обзора над проводящей цилиндрической 
поверхностью из излучателей вертикальной поляризации~// Известия Гомельского государственного университета имени Ф. Скорины. 
Сер.: Естественные науки. 2014. С.~191--198.

%rus
\bibitem{yurkov:knd}
\textbf{Юрков\;A.\;С.} Максимизация направленности фазированных антенных решеток коротковолнового диапазона~// Научно-технический сборник <<Техника радиосвязи>> 
Омск, ОНИИП, 2016. №~2, С.~46--53.

%rus
\bibitem{yurkov:farkv}
\textbf{Юрков\;A.\;С.} Оптимизация возбуждения передающих фазированных антенных решеток декаметрового диапазона длин волн. 
ОНИИП, Омск, 2014.

\bibitem{fuchs:application}
\textbf{Fuchs\;B.} Application of convex relaxation to array synthesis problems~// IEEE Transactions on Antennas and Propagation~62(2). 2014. P.~634--640.

\bibitem{murty:np}
\textbf{Murty\;K.} Some NP-complete problems in quadratic and nonlinear programming~// Mathematical Programming. North Holand~39. 1987. P.~117--129.

%rus
\bibitem{nechaeva:bandb}
\textbf{Нечаева\;М.\;С., Хамисов\;О.\;В.} Метод ветвей и границ для задачи минимизации невыпуклой квадратичной функции при выпуклых квадратичных ограничениях~//Дискретн. анализ и исслед. опер.~7(2). 2000. C.~74--88.

\bibitem{horst:handbook}
\textbf{Horst\;R., Pardalos\;P.\;M.} Handbook of global optimization. Springer Science \& Business Media, 2013. Vol.~2.

\bibitem{strekalovsky:mindc}
\textbf{Стрекаловский\;А.\;С.} О минимизации разности выпуклых функций на допустимом 
множестве~//Журн. вычисл. матем. и матем. физ. Т.~43, №~3. 2003. C.~399--409.

\bibitem{boriskinetal:efficient}
\textbf{Boriskin\;A.\;V., Balaban\;M.\;V., Galan\;O.\;Yu., Sauleau\;R.} Efficient approach for fast synthesis of phased arrays with the aid of a hybrid genetic algorithm and a smart feed representation~//2010 IEEE International Symposium on Phased Array Systems and Technology. 2010. P.~827--832.

\bibitem{rao:synthesis}
\textbf{Rao\;A., Sarma\;N.} Synthesis of reconfigurable antenna array using differential evolution algorithm~//IETE Journal of Research~63(3). 2017. P.~827--832.

\bibitem{kochetov:local}
\textbf{Кочетов\;Ю.\;А.} Вычислительные возможности локального поиска в комбинаторной 
оптимизации~//Журн. вычисл. матем. и матем. физ. Т.~48, №~5. 2008. C.~747--763.

%\bibitem{tyu:motor22}
%\textbf{Eremeev\;A., Tiunin\;N.} Differential evolution for short wave antenna array optimization~//Mathematical 
%Optimization Theory and Operations Research. 2022. https://easychair.org/smart-program/MOTOR2022/2022-07-04.html\#talk:195757 (accessed: 27.08.2022).

%rus
\bibitem{tyunin:daor}
\textbf{Тюнин\;Н.\;Н.} Задачи невыпуклого квадратичного программирования, связанные с оптимизацией фазированных антенных решёток~//Дискретный
анализ и исследование операций. Т.~28, №~3. 2021. C.~65--89.

\bibitem{storn:de}
\textbf{Storn\;R.,Price\;K.} Differential evolution--a simple and efficient heuristic for global optimization over continuous 
spaces~// Journal of Global Optimization~11(4). 1997. P.~341--359.

\bibitem{das:de}
\textbf{Das\;S., Suganthan\;P.\;N.} Differential evolution: A survey of the 
state-of-the-art~//IEEE Transactions on Evolutionary Computation~15(1). 2011. P.~4--31.

\bibitem{nelder:simplex}
\textbf{Nelder\;J.\;A., Mead\;R.} A simplex method for function minimization~//The Computer Journal~7(4). 1965. P.~308--311.

%\bibitem{price:global}
%\textbf{Price\;W.} Journal of optimization theory and Applications~//The Computer Journal~40(3). 1983. P.~333--348.

\bibitem{storn:de_practical}
\textbf{Price\;K.\;V., Storn\;R.\;M., Lampinen\;J.\;A.} Differential Evolution. A Practical Approach to Global Optimization. 
Springer, 2005.

\bibitem{BN98} \textbf{Balas\;E., Niehaus\;W.}  Optimized crossover-based genetic algorithms for the maximum 
cardinality and maximum weight clique problems~//Journal of Heuristics~4(2). 1998. P.107--122.

\bibitem{HK93} \textbf{Hampson\;S., Kibler\;D.} Plateaus and plateau search
in Boolean satisfiability problems: When to give up searching and
start again~//Proceedings of the second DIMACS Implementation
Challenge ``Cliques, Coloring and Satisfiability''. 
American Mathematical Society. 1996. P.437--456.

%rus
\bibitem{tyunin:oniip}
\textbf{Тюнин\;Н.\;Н.} Об оптимизации направленности коротковолновых фазированных антенных решеток кольцевой 
структуры~//Научно-технический сборник <<Техника радиосвязи>>, Омск, ОНИИП, 2022 (в печати).


\bibitem{yurkov:symmetry}
\textbf{Eremeev\;A.\;V., Yurkov\;A.\;S.} On symmetry groups of some quadratic programming problems~//Proceedings of Mathematical 
Optimization Theory and Operations Research. MOTOR 2020 (Novosibirsk, Russia, July 6–10, 2020). Springer, LNCS~12095. 2020. P.35--48.

\end{thebibliography}

\endarticle  %  Команда завершения статьи
\end{document}
